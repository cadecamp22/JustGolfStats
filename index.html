<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>Golf Round Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            min-height: 100vh;
            padding: 10px;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 20px;
            padding: 10px;
        }

        .header h1 {
            font-size: 2rem;
            margin-bottom: 5px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
        }

        .login-container {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            margin: 50px auto;
            max-width: 400px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .login-container h2 {
            color: #2a5298;
            margin-bottom: 20px;
            text-align: center;
        }

        .login-form {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .main-menu {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .menu-card {
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .menu-card:hover {
            transform: translateY(-5px);
        }

        .menu-card h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .menu-card p {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .round-history {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .history-item {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: background 0.3s ease;
        }

        .history-item:hover {
            background: #e9ecef;
        }

        .history-info h4 {
            color: #2a5298;
            margin-bottom: 5px;
        }

        .history-stats {
            text-align: right;
        }

        .score-display {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2a5298;
        }

        .round-setup {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .setup-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }

        .input-group {
            margin-bottom: 10px;
        }

        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #2a5298;
            box-shadow: 0 0 0 3px rgba(42, 82, 152, 0.1);
        }

        .hole-setup-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            gap: 10px;
            margin-bottom: 15px;
        }

        .hole-setup-item {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 10px;
            text-align: center;
        }

        .hole-setup-item label {
            font-size: 12px;
            font-weight: bold;
            color: #2a5298;
            display: block;
            margin-bottom: 5px;
        }

        .hole-setup-item select,
        .hole-setup-item input {
            width: 100%;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
            margin-bottom: 5px;
        }

        .hole-tracker {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .hole-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #e0e0e0;
            flex-wrap: wrap;
            gap: 15px;
        }

        .hole-number {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2a5298;
        }

        .hole-info {
            display: flex;
            gap: 20px;
            align-items: center;
            flex-wrap: wrap;
        }

        .hole-detail {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
        }

        .hole-detail label {
            font-size: 12px;
            font-weight: 600;
            color: #666;
            text-transform: uppercase;
        }

        .hole-display {
            padding: 8px 12px;
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            min-width: 70px;
        }

        .tracking-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .track-item {
            text-align: center;
        }

        .track-item label {
            display: block;
            font-size: 12px;
            font-weight: 600;
            color: #666;
            margin-bottom: 8px;
            text-transform: uppercase;
        }

        .track-input {
            width: 60px;
            height: 50px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            margin: 0 auto;
            display: block;
        }

        .track-checkbox {
            width: 40px;
            height: 40px;
            margin: 0 auto;
            display: block;
            transform: scale(1.5);
            cursor: pointer;
        }

        .track-display {
            width: 60px;
            height: 50px;
            font-size: 18px;
            font-weight: bold;
            text-align: center;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
        }

        .gir-yes {
            background: #d4edda !important;
            border-color: #28a745 !important;
            color: #155724;
        }

        .gir-no {
            background: #f8d7da !important;
            border-color: #dc3545 !important;
            color: #721c24;
        }

        .penalty-section {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .penalty-section h4 {
            color: #856404;
            margin-bottom: 10px;
            font-size: 14px;
        }

        .penalty-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 10px;
        }

        .penalty-btn {
            padding: 8px 12px;
            background: white;
            border: 2px solid #ffeaa7;
            border-radius: 8px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s ease;
        }

        .penalty-btn.active {
            background: #ffeaa7;
            border-color: #f39c12;
        }

        .putting-section {
            background: #f0f8ff;
            border: 1px solid #add8e6;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .putt-input-area {
            background: white;
            border-radius: 8px;
            padding: 10px;
        }

        .btn-putt {
            padding: 6px 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            font-weight: 600;
            transition: all 0.3s ease;
            background: #2a5298;
            color: white;
        }

        .btn-putt:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(42, 82, 152, 0.3);
        }

        .btn-made {
            background: #28a745 !important;
        }

        .btn-made:hover {
            box-shadow: 0 4px 8px rgba(40, 167, 69, 0.3) !important;
        }

        .putt-list {
            margin-top: 10px;
            min-height: 30px;
        }

        .putt-item {
            display: inline-block;
            background: #e9ecef;
            padding: 4px 8px;
            margin: 2px;
            border-radius: 12px;
            font-size: 12px;
            color: #495057;
        }

        .putt-item.made {
            background: #d4edda;
            color: #155724;
        }

        .putt-item .remove-putt {
            margin-left: 5px;
            color: #dc3545;
            cursor: pointer;
            font-weight: bold;
        }

        .putt-item .remove-putt:hover {
            color: #c82333;
        }

        .strokes-gained-section {
            background: #e8f5e8;
            border: 1px solid #28a745;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }

        .sg-putting-display {
            font-size: 1.2rem;
            font-weight: bold;
            text-align: center;
            margin: 10px 0;
        }

        .sg-putting-display.positive {
            color: #28a745;
        }

        .sg-putting-display.negative {
            color: #dc3545;
        }

        .hole-navigation {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 10px;
        }

        .nav-btn {
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            max-width: 150px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #2a5298 0%, #1e3c72 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(42, 82, 152, 0.3);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(42, 82, 152, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(40, 167, 69, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545 0%, #c82333 100%);
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
        }

        .round-summary {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }

        .summary-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-box {
            text-align: center;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #2a5298;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: #2a5298;
            margin-bottom: 5px;
        }

        .stat-label {
            color: #666;
            font-size: 0.8rem;
            text-transform: uppercase;
        }

        .scorecard {
            overflow-x: auto;
            margin-top: 20px;
        }

        .scorecard-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 12px;
            min-width: 600px;
        }

        .scorecard-table th,
        .scorecard-table td {
            padding: 8px 4px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .scorecard-table th {
            background: #2a5298;
            color: white;
            font-weight: 600;
        }

        .user-info {
            position: absolute;
            top: 10px;
            right: 10px;
            color: white;
            text-align: right;
        }

        .user-info button {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 5px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 5px;
        }

        .hidden {
            display: none;
        }

        @media (max-width: 768px) {
            .tracking-grid {
                grid-template-columns: repeat(3, 1fr);
            }

            .hole-navigation {
                flex-direction: column;
            }

            .nav-btn {
                max-width: none;
                width: 100%;
            }

            .menu-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>⛳ Golf Round Tracker</h1>
            <p>Track every shot, improve your game</p>
        </div>

        <div class="user-info hidden" id="userInfo">
            <div id="userName"></div>
            <button onclick="logout()">Logout</button>
        </div>

        <!-- Login Screen -->
        <div class="login-container" id="loginScreen">
            <h2>Welcome Back!</h2>
            <form class="login-form" onsubmit="login(event)">
                <div class="input-group">
                    <label for="username">Username</label>
                    <input type="text" id="username" required placeholder="Enter your username">
                </div>
                <div class="input-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" required placeholder="Enter your password">
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">Login</button>
            </form>
            <p style="text-align: center; margin-top: 20px; color: #666; font-size: 14px;">
                First time? Use any username/password to create an account
            </p>
        </div>

        <!-- Main Menu -->
        <div class="main-menu hidden" id="mainMenu">
            <h2 style="color: #2a5298; margin-bottom: 10px;">What would you like to do?</h2>
            <div class="menu-grid">
                <div class="menu-card" onclick="showNewRound()">
                    <h3>🏌️ New Round</h3>
                    <p>Start tracking a new round</p>
                </div>
                <div class="menu-card" onclick="showHistory()">
                    <h3>📊 View History</h3>
                    <p>See all your past rounds</p>
                </div>
                <div class="menu-card" onclick="showStats()">
                    <h3>📈 Statistics</h3>
                    <p>Analyze your performance</p>
                </div>
            </div>
        </div>

        <!-- Round History -->
        <div class="round-history hidden" id="roundHistory">
            <h2 style="color: #2a5298; margin-bottom: 20px;">Round History</h2>
            <div id="historyList"></div>
            <button class="btn-primary" onclick="showMainMenu()" style="width: 100%; margin-top: 20px;">Back to
                Menu</button>
        </div>

        <!-- Statistics View -->
        <div class="round-history hidden" id="statsView">
            <h2 style="color: #2a5298; margin-bottom: 20px;">Your Statistics</h2>
            <div id="statsContent"></div>
            <button class="btn-primary" onclick="showMainMenu()" style="width: 100%; margin-top: 20px;">Back to
                Menu</button>
        </div>

        <!-- Round Setup -->
        <div class="round-setup hidden" id="roundSetup">
            <h3>New Round Setup</h3>
            <div class="setup-grid">
                <div class="input-group">
                    <label for="setupDate">Date:</label>
                    <input type="date" id="setupDate">
                </div>
                <div class="input-group">
                    <label for="setupCourse">Course:</label>
                    <input type="text" id="setupCourse" placeholder="Course name">
                </div>
                <div class="input-group">
                    <label for="setupTees">Tee Box:</label>
                    <select id="setupTees">
                        <option value="">Select tees</option>
                        <option value="Championship">Championship (Black)</option>
                        <option value="Back">Back (Blue)</option>
                        <option value="Regular">Regular (White)</option>
                        <option value="Forward">Forward (Red)</option>
                        <option value="Senior">Senior (Gold)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label for="setupHoles">Round Type:</label>
                    <select id="setupHoles" onchange="updateHoleDisplay()">
                        <option value="18">18 Holes</option>
                        <option value="9">9 Holes (Front)</option>
                        <option value="back9">9 Holes (Back)</option>
                    </select>
                </div>
            </div>

            <div
                style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px; border-left: 4px solid #2a5298;">
                <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                    <input type="checkbox" id="enableStrokesGained" checked style="transform: scale(1.2);">
                    <label for="enableStrokesGained" style="font-weight: 600; color: #2a5298; margin: 0;">Enable Strokes
                        Gained Analysis</label>
                </div>
                <p style="color: #666; font-size: 13px; margin: 0;">
                    Track approach shot distances for advanced performance analysis vs PGA Tour averages.
                    Turn off for faster round entry with basic stats only.
                </p>
            </div>

            <div style="margin-top: 20px;">
                <h4 style="color: #2a5298; margin-bottom: 15px;">Course Layout</h4>

                <!-- Front 9 -->
                <div style="margin-bottom: 20px;">
                    <h5 style="color: #2a5298; margin-bottom: 10px;">Front Nine</h5>
                    <div class="hole-setup-grid" id="front9Setup"></div>
                </div>

                <!-- Back 9 -->
                <div style="margin-bottom: 20px;">
                    <h5 style="color: #2a5298; margin-bottom: 10px;">Back Nine</h5>
                    <div class="hole-setup-grid" id="back9Setup"></div>
                </div>

                <div style="text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <span style="font-size: 16px; color: #2a5298;">Total Par: <strong id="totalPar">72</strong></span>
                </div>
            </div>

            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button class="btn-primary" onclick="startRound()" style="flex: 1;">Start Round</button>
                <button class="btn-secondary" onclick="showMainMenu()" style="flex: 1;">Cancel</button>
            </div>
        </div>

        <!-- Hole Tracker -->
        <div class="hole-tracker hidden" id="holeTracker">
            <div class="hole-header">
                <div class="hole-number">Hole <span id="currentHoleNum">1</span></div>
                <div class="hole-info">
                    <div class="hole-detail">
                        <label>Par:</label>
                        <span id="displayPar" class="hole-display">4</span>
                    </div>
                    <div class="hole-detail">
                        <label>Yardage:</label>
                        <span id="displayYardage" class="hole-display">-</span>
                    </div>
                </div>
            </div>

            <div class="tracking-grid" id="trackingGrid">
                <div class="track-item">
                    <label>Score</label>
                    <select class="track-input" id="score" style="height: 50px; font-size: 18px; font-weight: bold;">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4" selected>4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                    </select>
                </div>
                <div class="track-item" id="approachYardsItem" style="display: none;">
                    <label>Approach Yards</label>
                    <input type="number" class="track-input" id="approachYards" min="0" max="300" placeholder="Yds">
                </div>
                <div class="track-item">
                    <label>Total Putts</label>
                    <input type="number" class="track-input" id="putts" min="0" max="8" value="2">
                </div>
                <div class="track-item" id="fairwayItem">
                    <label>Fairway</label>
                    <input type="checkbox" class="track-checkbox" id="fairway">
                </div>
                <div class="track-item">
                    <label>GIR (Auto)</label>
                    <div class="track-display" id="girDisplay">-</div>
                </div>
                <div class="track-item">
                    <label>Up & Down</label>
                    <input type="checkbox" class="track-checkbox" id="updown">
                </div>
            </div>

            <!-- Putting Tracker Section -->
            <div class="putting-section" id="puttingSection" style="display: none;">
                <h4 style="color: #2a5298; margin-bottom: 15px; display: flex; align-items: center; gap: 10px;">
                    🏌️‍♂️ Putting Tracker
                    <span style="font-size: 12px; color: #666; font-weight: normal;">(for Strokes Gained
                        analysis)</span>
                </h4>

                <div class="putt-input-area">
                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px; flex-wrap: wrap;">
                        <div style="display: flex; align-items: center; gap: 5px;">
                            <label for="puttDistance" style="font-size: 14px; color: #333;">Distance:</label>
                            <input type="number" id="puttDistance" min="1" max="100" placeholder="ft"
                                style="width: 60px; padding: 5px; border: 1px solid #ddd; border-radius: 4px;">
                        </div>
                        <button class="btn-putt" onclick="addPutt()">Add Putt</button>
                        <button class="btn-putt btn-made" onclick="addMadePutt()">Made It!</button>
                    </div>

                    <div class="putt-list" id="puttList">
                        <p style="color: #666; font-size: 12px; margin: 0;">No putts recorded yet</p>
                    </div>
                </div>
            </div>

            <div class="penalty-section">
                <h4>Penalties (if any):</h4>
                <div class="penalty-options">
                    <button class="penalty-btn active" data-penalty="none">None</button>
                    <button class="penalty-btn" data-penalty="ob">OB (+1)</button>
                    <button class="penalty-btn" data-penalty="water">Water (+1)</button>
                    <button class="penalty-btn" data-penalty="lost">Lost Ball (+1)</button>
                </div>
            </div>

            <div class="hole-navigation">
                <button class="nav-btn btn-primary" id="prevBtn" onclick="previousHole()" disabled>Previous</button>
                <button class="nav-btn btn-primary" id="nextBtn" onclick="nextHole()">Next Hole</button>
                <button class="nav-btn btn-primary hidden" id="finishBtn" onclick="finishRound()">Finish Round</button>
            </div>
        </div>

        <!-- Round Summary -->
        <div class="round-summary hidden" id="roundSummary">
            <h3>Round Complete! 🎉</h3>
            <div class="summary-stats">
                <div class="stat-box">
                    <div class="stat-value" id="finalScore">-</div>
                    <div class="stat-label">Total Score</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="finalVsPar">-</div>
                    <div class="stat-label">vs Par</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="finalFairways">-</div>
                    <div class="stat-label">Fairways %</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="finalGIR">-</div>
                    <div class="stat-label">GIR %</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="finalPutts">-</div>
                    <div class="stat-label">Total Putts</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="finalSGOffTee">-</div>
                    <div class="stat-label">SG Off Tee</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="finalSGApproach">-</div>
                    <div class="stat-label">SG Approach</div>
                </div>
                <div class="stat-box">
                    <div class="stat-value" id="finalSGPutting">-</div>
                    <div class="stat-label">SG Putting</div>
                </div>
            </div>

            <div class="strokes-gained-section">
                <h4 style="color: #28a745; margin-bottom: 10px; text-align: center;">🎯 Putting Performance vs PGA Tour
                </h4>
                <div id="sgPuttingBreakdown"></div>
            </div>

            <div class="strokes-gained-section" style="background: #fff3e0; border-color: #ff9800;">
                <h4 style="color: #ff9800; margin-bottom: 10px; text-align: center;">🏌️ Off The Tee Analysis</h4>
                <div id="sgOffTeeBreakdown" style="text-align: center; font-size: 13px; color: #333;">
                </div>
            </div>

            <div class="strokes-gained-section" style="background: #e8f4fd; border-color: #2a5298;">
                <h4 style="color: #2a5298; margin-bottom: 10px; text-align: center;">🏌️ Approach Shot Analysis</h4>
                <div id="sgApproachBreakdown" style="text-align: center; font-size: 13px; color: #333;">
                </div>
            </div>

            <div class="scorecard">
                <table class="scorecard-table">
                    <thead>
                        <tr>
                            <th>Hole</th>
                            <th>1</th>
                            <th>2</th>
                            <th>3</th>
                            <th>4</th>
                            <th>5</th>
                            <th>6</th>
                            <th>7</th>
                            <th>8</th>
                            <th>9</th>
                            <th>Out</th>
                            <th>10</th>
                            <th>11</th>
                            <th>12</th>
                            <th>13</th>
                            <th>14</th>
                            <th>15</th>
                            <th>16</th>
                            <th>17</th>
                            <th>18</th>
                            <th>In</th>
                            <th>Total</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Par</strong></td>
                            <td id="par1">-</td>
                            <td id="par2">-</td>
                            <td id="par3">-</td>
                            <td id="par4">-</td>
                            <td id="par5">-</td>
                            <td id="par6">-</td>
                            <td id="par7">-</td>
                            <td id="par8">-</td>
                            <td id="par9">-</td>
                            <td id="parOut">-</td>
                            <td id="par10">-</td>
                            <td id="par11">-</td>
                            <td id="par12">-</td>
                            <td id="par13">-</td>
                            <td id="par14">-</td>
                            <td id="par15">-</td>
                            <td id="par16">-</td>
                            <td id="par17">-</td>
                            <td id="par18">-</td>
                            <td id="parIn">-</td>
                            <td id="parTotal">-</td>
                        </tr>
                        <tr>
                            <td><strong>Score</strong></td>
                            <td id="score1">-</td>
                            <td id="score2">-</td>
                            <td id="score3">-</td>
                            <td id="score4">-</td>
                            <td id="score5">-</td>
                            <td id="score6">-</td>
                            <td id="score7">-</td>
                            <td id="score8">-</td>
                            <td id="score9">-</td>
                            <td id="scoreOut">-</td>
                            <td id="score10">-</td>
                            <td id="score11">-</td>
                            <td id="score12">-</td>
                            <td id="score13">-</td>
                            <td id="score14">-</td>
                            <td id="score15">-</td>
                            <td id="score16">-</td>
                            <td id="score17">-</td>
                            <td id="score18">-</td>
                            <td id="scoreIn">-</td>
                            <td id="scoreTotal">-</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div style="text-align: center; margin-top: 20px;">
                <button class="btn-secondary" onclick="showMainMenu()" style="margin-right: 10px;">Back to Menu</button>
                <button class="btn-primary" onclick="showNewRound()">New Round</button>
            </div>
        </div>
    </div>

    <script>
        // Default par values for each hole
        const DEFAULT_PARS = [4, 4, 3, 4, 5, 4, 3, 4, 5, 4, 4, 3, 4, 5, 4, 3, 4, 5];

        // PGA Tour putting data - make percentages by distance
        const PGA_PUTTING_DATA = {
            3: 99.57, 4: 91.97, 5: 81.09, 6: 70.28, 7: 60.76, 8: 53.71,
            9: 45.39, 10: 40.63, 12: 30.36, 17: 18.57, 22: 12.13, 30: 5.21
        };

        // PGA Tour approach baseline data - expected strokes to hole out by distance
        const APPROACH_BASELINE_DATA = {
            50: 2.5,    // Extrapolated
            75: 2.65,   // Extrapolated  
            100: 2.80,  // From research data
            115: 2.825, // From research data
            125: 2.86,  // Interpolated
            140: 2.91,  // From research data
            150: 2.945, // Interpolated
            160: 2.98,  // From research data
            175: 3.055, // Interpolated
            200: 3.16,  // From research data
            225: 3.28,  // Extrapolated
            250: 3.42,  // Extrapolated
            275: 3.58,  // Extrapolated
            300: 3.75   // Extrapolated
        };

        // PGA Tour tee baseline data - expected strokes from tee by hole length
        const TEE_BASELINE_DATA = {
            100: 2.92,  // Very short par 3s
            200: 3.12,  // Short par 3s
            300: 3.71,  // Long par 3s / Short par 4s
            360: 3.92,  // Medium par 4s
            400: 3.99,  // Long par 4s
            450: 4.08,  // Very long par 4s
            460: 4.17,  // Short par 5s
            500: 4.41,  // Medium par 5s
            550: 4.65,  // Long par 5s
            600: 4.85   // Very long par 5s
        };

        let currentUser = null;
        let currentRound = {
            date: '',
            course: '',
            tees: '',
            holes: [],
            currentHole: 0,
            roundType: '18' // Track round type
        };

        // Calculate GIR automatically
        function calculateGIR(par, score, putts) {
            const strokesToGreen = score - putts;
            const regulationStrokes = par - 2;
            return strokesToGreen <= regulationStrokes;
        }

        // Update GIR display
        function updateGIRDisplay() {
            const hole = currentRound.holes[currentRound.currentHole];
            const score = parseInt(document.getElementById('score').value) || hole.par;
            const putts = parseInt(document.getElementById('putts').value) || 0;
            const gir = calculateGIR(hole.par, score, putts);

            const girDisplay = document.getElementById('girDisplay');
            girDisplay.textContent = gir ? 'YES' : 'NO';
            girDisplay.className = 'track-display ' + (gir ? 'gir-yes' : 'gir-no');

            // Update the hole data
            hole.gir = gir;
        }

        // Get expected strokes from tee using interpolation
        function getExpectedStrokesFromTee(holeYardage) {
            if (!holeYardage || holeYardage <= 0) return 0;

            // Get sorted distances from baseline data
            const distances = Object.keys(TEE_BASELINE_DATA).map(Number).sort((a, b) => a - b);

            // If distance is at or below minimum, use minimum value
            if (holeYardage <= distances[0]) {
                return TEE_BASELINE_DATA[distances[0]];
            }

            // If distance is at or above maximum, use maximum value  
            if (holeYardage >= distances[distances.length - 1]) {
                return TEE_BASELINE_DATA[distances[distances.length - 1]];
            }

            // Find the two points to interpolate between
            let lowerDistance = distances[0];
            let upperDistance = distances[distances.length - 1];

            for (let i = 0; i < distances.length - 1; i++) {
                if (holeYardage >= distances[i] && holeYardage <= distances[i + 1]) {
                    lowerDistance = distances[i];
                    upperDistance = distances[i + 1];
                    break;
                }
            }

            // Linear interpolation
            const lowerStrokes = TEE_BASELINE_DATA[lowerDistance];
            const upperStrokes = TEE_BASELINE_DATA[upperDistance];
            const ratio = (holeYardage - lowerDistance) / (upperDistance - lowerDistance);

            return lowerStrokes + (upperStrokes - lowerStrokes) * ratio;
        }

        // Get expected strokes for approach shots using interpolation
        function getExpectedStrokesApproach(distanceYards) {
            if (!distanceYards || distanceYards <= 0) return 0;

            // Get sorted distances from baseline data
            const distances = Object.keys(APPROACH_BASELINE_DATA).map(Number).sort((a, b) => a - b);

            // If distance is at or below minimum, use minimum value
            if (distanceYards <= distances[0]) {
                return APPROACH_BASELINE_DATA[distances[0]];
            }

            // If distance is at or above maximum, use maximum value  
            if (distanceYards >= distances[distances.length - 1]) {
                return APPROACH_BASELINE_DATA[distances[distances.length - 1]];
            }

            // Find the two points to interpolate between
            let lowerDistance = distances[0];
            let upperDistance = distances[distances.length - 1];

            for (let i = 0; i < distances.length - 1; i++) {
                if (distanceYards >= distances[i] && distanceYards <= distances[i + 1]) {
                    lowerDistance = distances[i];
                    upperDistance = distances[i + 1];
                    break;
                }
            }

            // Linear interpolation
            const lowerStrokes = APPROACH_BASELINE_DATA[lowerDistance];
            const upperStrokes = APPROACH_BASELINE_DATA[upperDistance];
            const ratio = (distanceYards - lowerDistance) / (upperDistance - lowerDistance);

            return lowerStrokes + (upperStrokes - lowerStrokes) * ratio;
        }

        // Calculate expected strokes from distance using PGA Tour data
        function getExpectedStrokes(distanceFt) {
            // Convert distance to closest data point
            let makePercentage;

            if (distanceFt <= 3) makePercentage = PGA_PUTTING_DATA[3];
            else if (distanceFt <= 4) makePercentage = PGA_PUTTING_DATA[4];
            else if (distanceFt <= 5) makePercentage = PGA_PUTTING_DATA[5];
            else if (distanceFt <= 6) makePercentage = PGA_PUTTING_DATA[6];
            else if (distanceFt <= 7) makePercentage = PGA_PUTTING_DATA[7];
            else if (distanceFt <= 8) makePercentage = PGA_PUTTING_DATA[8];
            else if (distanceFt <= 9) makePercentage = PGA_PUTTING_DATA[9];
            else if (distanceFt <= 10) makePercentage = PGA_PUTTING_DATA[10];
            else if (distanceFt <= 15) makePercentage = PGA_PUTTING_DATA[12];
            else if (distanceFt <= 20) makePercentage = PGA_PUTTING_DATA[17];
            else if (distanceFt <= 25) makePercentage = PGA_PUTTING_DATA[22];
            else makePercentage = PGA_PUTTING_DATA[30];

            // Convert percentage to decimal
            const makeRate = makePercentage / 100;

            // Expected strokes = 1 + miss_rate * expected_strokes_after_miss
            // Assume misses leave about 3 feet on average
            const expectedAfterMiss = 1 / (PGA_PUTTING_DATA[3] / 100);

            return 1 + (1 - makeRate) * expectedAfterMiss;
        }

        // Putting functions
        function addPutt() {
            const distance = parseInt(document.getElementById('puttDistance').value);
            if (!distance || distance < 1) {
                alert('Please enter a valid distance');
                return;
            }

            const hole = currentRound.holes[currentRound.currentHole];
            if (!hole.putts_detail) hole.putts_detail = [];

            hole.putts_detail.push({ distance: distance, made: false });
            document.getElementById('puttDistance').value = '';
            updatePuttDisplay();
            updatePuttCount();
        }

        function addMadePutt() {
            const distance = parseInt(document.getElementById('puttDistance').value);
            if (!distance || distance < 1) {
                alert('Please enter a valid distance');
                return;
            }

            const hole = currentRound.holes[currentRound.currentHole];
            if (!hole.putts_detail) hole.putts_detail = [];

            hole.putts_detail.push({ distance: distance, made: true });
            document.getElementById('puttDistance').value = '';
            updatePuttDisplay();
            updatePuttCount();
        }

        function removePutt(index) {
            const hole = currentRound.holes[currentRound.currentHole];
            hole.putts_detail.splice(index, 1);
            updatePuttDisplay();
            updatePuttCount();
        }

        function updatePuttDisplay() {
            const hole = currentRound.holes[currentRound.currentHole];
            const putts = hole.putts_detail || [];
            const puttList = document.getElementById('puttList');

            if (putts.length === 0) {
                puttList.innerHTML = '<p style="color: #666; font-size: 12px; margin: 0;">No putts recorded yet</p>';
                return;
            }

            puttList.innerHTML = putts.map((putt, index) => `
                <span class="putt-item ${putt.made ? 'made' : ''}">
                    ${putt.distance}ft ${putt.made ? '✓' : ''}
                    <span class="remove-putt" onclick="removePutt(${index})">×</span>
                </span>
            `).join('');
        }

        function updatePuttCount() {
            // Only update putts automatically if strokes gained is enabled
            if (!currentRound.enableStrokesGained) return;

            const hole = currentRound.holes[currentRound.currentHole];
            const puttCount = hole.putts_detail ? hole.putts_detail.length : 0;
            document.getElementById('putts').value = puttCount;
            hole.putts = puttCount;
            updateGIRDisplay(); // Update GIR when putts change
        }

        function calculateStrokesGainedOffTee() {
            // Skip calculation if strokes gained is disabled
            if (!currentRound.enableStrokesGained) {
                return { total: 0, holesWithData: 0, average: 0 };
            }

            let totalSG = 0;
            let holesWithData = 0;

            currentRound.holes.forEach(hole => {
                // SG Off The Tee only applies to par 4s and 5s (not par 3s)
                if (hole.par === 3) return;

                // Need both hole yardage and approach yardage to calculate
                if (!hole.yardage || !hole.approachYards || hole.approachYards <= 0) return;

                // Get expected strokes from tee for this hole length
                const expectedFromTee = getExpectedStrokesFromTee(hole.yardage);

                // Get expected strokes from where they ended up after tee shot
                const expectedFromEndPosition = getExpectedStrokesApproach(hole.approachYards);

                // Strokes gained = expected from tee - expected from end position - 1 (stroke taken)
                const strokesGained = expectedFromTee - expectedFromEndPosition - 1;

                totalSG += strokesGained;
                holesWithData++;
            });

            return {
                total: totalSG,
                holesWithData: holesWithData,
                average: holesWithData > 0 ? totalSG / holesWithData : 0
            };
        }

        function calculateStrokesGainedApproach() {
            // Skip calculation if strokes gained is disabled
            if (!currentRound.enableStrokesGained) {
                return { total: 0, holesWithData: 0, average: 0 };
            }

            let totalSG = 0;
            let holesWithData = 0;

            currentRound.holes.forEach(hole => {
                if (!hole.approachYards || hole.approachYards <= 0) return;

                // Get expected strokes from approach distance to hole out
                const expectedStrokes = getExpectedStrokesApproach(hole.approachYards);

                // Calculate actual strokes from approach position to hole completion
                // This should be: approach shot (1) + putts + any additional shots around green
                // For holes where they hit GIR: actualStrokes = 1 + putts
                // For holes where they missed green: actualStrokes = total score - (drives + penalties)

                let actualStrokes;
                if (hole.gir) {
                    // Hit green in regulation: approach + putts
                    actualStrokes = 1 + hole.putts;
                } else {
                    // Missed green: need to account for chips/pitches
                    // This is total score minus the tee shot(s) that got them to approach position
                    // For simplicity, assume 1 tee shot, so actual from approach = score - 1
                    actualStrokes = hole.score - 1;
                }

                // Strokes gained = expected - actual
                const strokesGained = expectedStrokes - actualStrokes;
                totalSG += strokesGained;
                holesWithData++;
            });

            return {
                total: totalSG,
                holesWithData: holesWithData,
                average: holesWithData > 0 ? totalSG / holesWithData : 0
            };
        }

        function calculateStrokesGainedPutting() {
            // Skip calculation if strokes gained is disabled
            if (!currentRound.enableStrokesGained) {
                return { total: 0, breakdown: [] };
            }

            let totalSG = 0;
            let breakdown = [];

            currentRound.holes.forEach(hole => {
                if (!hole.putts_detail || hole.putts_detail.length === 0) return;

                let holeSG = 0;
                let remainingDistance = hole.putts_detail[0]?.distance || 0;

                hole.putts_detail.forEach((putt, index) => {
                    const expectedBefore = getExpectedStrokes(putt.distance);
                    const actualStrokes = 1;

                    let expectedAfter;
                    if (putt.made) {
                        expectedAfter = 0; // Holed out
                    } else {
                        // Assume miss leaves 3 feet (could be refined)
                        expectedAfter = getExpectedStrokes(3);
                    }

                    const strokesGained = expectedBefore - (actualStrokes + expectedAfter);
                    holeSG += strokesGained;
                });

                totalSG += holeSG;
                breakdown.push({
                    hole: hole.number,
                    sg: holeSG,
                    putts: hole.putts_detail.length
                });
            });

            return { total: totalSG, breakdown: breakdown };
        }

        // Initialize on page load
        window.addEventListener('DOMContentLoaded', function () {
            setupHoleInputs();
            checkAuth();
        });

        // Authentication functions
        function checkAuth() {
            const user = JSON.parse(localStorage.getItem('golfTrackerUser') || 'null');
            if (user) {
                currentUser = user;
                showUserInfo();
                showMainMenu();
            } else {
                showLogin();
            }
        }

        function login(event) {
            event.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Simple authentication - in real app, this would be server-side
            const users = JSON.parse(localStorage.getItem('golfTrackerUsers') || '{}');

            if (!users[username]) {
                // Create new user
                users[username] = { password: btoa(password), rounds: [] };
                localStorage.setItem('golfTrackerUsers', JSON.stringify(users));
            } else if (users[username].password !== btoa(password)) {
                alert('Incorrect password');
                return;
            }

            currentUser = username;
            localStorage.setItem('golfTrackerUser', JSON.stringify(username));
            showUserInfo();
            showMainMenu();
        }

        function logout() {
            currentUser = null;
            localStorage.removeItem('golfTrackerUser');
            showLogin();
        }

        function showUserInfo() {
            document.getElementById('userInfo').classList.remove('hidden');
            document.getElementById('userName').textContent = `Welcome, ${currentUser}!`;
        }

        // Navigation functions
        function hideAllScreens() {
            document.querySelectorAll('.login-container, .main-menu, .round-history, .round-setup, .hole-tracker, .round-summary, #statsView').forEach(el => {
                el.classList.add('hidden');
            });
        }

        function showLogin() {
            hideAllScreens();
            document.getElementById('loginScreen').classList.remove('hidden');
            document.getElementById('userInfo').classList.add('hidden');
        }

        function showMainMenu() {
            hideAllScreens();
            document.getElementById('mainMenu').classList.remove('hidden');
        }

        function showNewRound() {
            hideAllScreens();
            document.getElementById('roundSetup').classList.remove('hidden');
            setTodayDate();
            setupPenaltyButtons();
            setupAutoSave();
        }

        function showHistory() {
            hideAllScreens();
            document.getElementById('roundHistory').classList.remove('hidden');
            loadRoundHistory();
        }

        function showStats() {
            hideAllScreens();
            document.getElementById('statsView').classList.remove('hidden');
            calculateUserStats();
        }

        // Setup hole inputs
        function setupHoleInputs() {
            const front9 = document.getElementById('front9Setup');
            const back9 = document.getElementById('back9Setup');

            // Create inputs for all 18 holes
            for (let i = 1; i <= 9; i++) {
                front9.innerHTML += createHoleSetupHTML(i);
            }
            for (let i = 10; i <= 18; i++) {
                back9.innerHTML += createHoleSetupHTML(i);
            }

            // Add event listeners for par changes
            document.querySelectorAll('.par-input').forEach(select => {
                select.addEventListener('change', updateTotalPar);
            });

            updateTotalPar();
        }

        function updateHoleDisplay() {
            const roundType = document.getElementById('setupHoles').value;
            const front9Div = document.getElementById('front9Setup').parentElement;
            const back9Div = document.getElementById('back9Setup').parentElement;

            if (roundType === '18') {
                front9Div.style.display = 'block';
                back9Div.style.display = 'block';
            } else if (roundType === '9') {
                front9Div.style.display = 'block';
                back9Div.style.display = 'none';
            } else if (roundType === 'back9') {
                front9Div.style.display = 'none';
                back9Div.style.display = 'block';
            }

            updateTotalPar();
        }

        function createHoleSetupHTML(holeNum) {
            const defaultPar = DEFAULT_PARS[holeNum - 1];
            return `
                <div class="hole-setup-item">
                    <label>Hole ${holeNum}</label>
                    <select class="par-input" id="par${holeNum}">
                        <option value="3" ${defaultPar === 3 ? 'selected' : ''}>Par 3</option>
                        <option value="4" ${defaultPar === 4 ? 'selected' : ''}>Par 4</option>
                        <option value="5" ${defaultPar === 5 ? 'selected' : ''}>Par 5</option>
                    </select>
                    <input type="number" id="yards${holeNum}" placeholder="Yards" min="50" max="700">
                </div>
            `;
        }

        function updateTotalPar() {
            const roundType = document.getElementById('setupHoles').value;
            let total = 0;
            let startHole = 1;
            let endHole = 18;

            // Determine which holes to count based on round type
            if (roundType === '9') {
                endHole = 9;
            } else if (roundType === 'back9') {
                startHole = 10;
                endHole = 18;
            }

            for (let i = startHole; i <= endHole; i++) {
                const parSelect = document.getElementById(`par${i}`);
                if (parSelect && parSelect.parentElement.parentElement.style.display !== 'none') {
                    total += parseInt(parSelect.value);
                }
            }
            document.getElementById('totalPar').textContent = total;
        }

        // Round setup functions
        function setTodayDate() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('setupDate').value = today;
        }

        function setupPenaltyButtons() {
            const penaltyBtns = document.querySelectorAll('.penalty-btn');
            penaltyBtns.forEach(btn => {
                btn.addEventListener('click', function () {
                    penaltyBtns.forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    saveCurrentHole();
                });
            });
        }

        function setupAutoSave() {
            ['score', 'fairway', 'updown'].forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', () => {
                        saveCurrentHole();
                        updateGIRDisplay();
                    });
                }
            });

            // Add putts listener for manual entry when SG is disabled
            const puttsElement = document.getElementById('putts');
            if (puttsElement) {
                puttsElement.addEventListener('change', () => {
                    saveCurrentHole();
                    updateGIRDisplay();
                });
            }

            // Only add approach yards listener if strokes gained is enabled
            const approachYardsElement = document.getElementById('approachYards');
            if (approachYardsElement) {
                approachYardsElement.addEventListener('change', () => {
                    saveCurrentHole();
                    updateGIRDisplay();
                });
            }

            // Add enter key support for putt distance input
            const puttDistanceElement = document.getElementById('puttDistance');
            if (puttDistanceElement) {
                puttDistanceElement.addEventListener('keypress', function (e) {
                    if (e.key === 'Enter') {
                        addPutt();
                    }
                });
            }
        }

        function startRound() {
            const date = document.getElementById('setupDate').value;
            const course = document.getElementById('setupCourse').value;
            const tees = document.getElementById('setupTees').value;
            const roundType = document.getElementById('setupHoles').value;
            const enableStrokesGained = document.getElementById('enableStrokesGained').checked;

            if (!date || !course) {
                alert('Please enter date and course name');
                return;
            }

            currentRound.date = date;
            currentRound.course = course;
            currentRound.tees = tees;
            currentRound.roundType = roundType;
            currentRound.enableStrokesGained = enableStrokesGained;
            currentRound.holes = [];
            currentRound.currentHole = 0;
            currentRound.id = Date.now(); // Unique ID for this round

            // Initialize holes based on round type
            let startHole = 1;
            let endHole = 18;

            if (roundType === '9') {
                endHole = 9;
            } else if (roundType === 'back9') {
                startHole = 10;
                endHole = 18;
            }

            for (let i = startHole; i <= endHole; i++) {
                const parSelect = document.getElementById(`par${i}`);
                const yardsInput = document.getElementById(`yards${i}`);

                currentRound.holes.push({
                    number: i,
                    par: parseInt(parSelect.value),
                    yardage: parseInt(yardsInput.value) || null,
                    score: parseInt(parSelect.value),
                    putts: 2,
                    putts_detail: [], // Store individual putt data
                    approachYards: null, // Distance of approach shot
                    fairway: false,
                    gir: false, // Will be calculated automatically
                    updown: false,
                    penalty: 'none'
                });
            }

            hideAllScreens();
            document.getElementById('holeTracker').classList.remove('hidden');
            loadHole(0);
        }

        // Hole tracking functions
        function updateFairwayVisibility(par) {
            const fairwayItem = document.getElementById('fairwayItem');
            if (par === 3) {
                fairwayItem.style.opacity = '0.3';
                fairwayItem.style.pointerEvents = 'none';
                document.getElementById('fairway').checked = false;
            } else {
                fairwayItem.style.opacity = '1';
                fairwayItem.style.pointerEvents = 'auto';
            }
        }

        function loadHole(holeIndex) {
            currentRound.currentHole = holeIndex;
            const hole = currentRound.holes[holeIndex];

            document.getElementById('currentHoleNum').textContent = hole.number;
            document.getElementById('displayPar').textContent = hole.par;
            document.getElementById('displayYardage').textContent = hole.yardage || '-';

            // Set score dropdown to the hole's score
            document.getElementById('score').value = hole.score.toString();

            document.getElementById('approachYards').value = hole.approachYards || '';
            document.getElementById('putts').value = hole.putts;
            document.getElementById('fairway').checked = hole.fairway;
            document.getElementById('updown').checked = hole.updown;

            // Show/hide strokes gained fields based on setting
            const approachYardsItem = document.getElementById('approachYardsItem');
            const puttingSection = document.getElementById('puttingSection');
            const puttsInput = document.getElementById('putts');

            if (currentRound.enableStrokesGained) {
                approachYardsItem.style.display = 'block';
                puttingSection.style.display = 'block';
                puttsInput.readOnly = true; // Controlled by putting tracker
            } else {
                approachYardsItem.style.display = 'none';
                puttingSection.style.display = 'none';
                puttsInput.readOnly = false; // Manual entry
            }

            // Initialize putts_detail if it doesn't exist
            if (!hole.putts_detail) {
                hole.putts_detail = [];
            }

            // Set penalty button
            document.querySelectorAll('.penalty-btn').forEach(btn => {
                btn.classList.remove('active');
                if (btn.dataset.penalty === hole.penalty) {
                    btn.classList.add('active');
                }
            });

            // Update navigation buttons based on hole count
            const totalHoles = currentRound.holes.length;
            const isLastHole = holeIndex === totalHoles - 1;

            document.getElementById('prevBtn').disabled = holeIndex === 0;

            if (isLastHole) {
                document.getElementById('nextBtn').classList.add('hidden');
                document.getElementById('finishBtn').classList.remove('hidden');
            } else {
                document.getElementById('nextBtn').classList.remove('hidden');
                document.getElementById('finishBtn').classList.add('hidden');
            }

            updateFairwayVisibility(hole.par);
            updatePuttDisplay();
            updateGIRDisplay();
        }

        function saveCurrentHole() {
            if (currentRound.holes.length === 0) return;

            const hole = currentRound.holes[currentRound.currentHole];
            hole.score = parseInt(document.getElementById('score').value) || hole.par;

            // Only save approach yards if strokes gained is enabled
            if (currentRound.enableStrokesGained) {
                hole.approachYards = parseInt(document.getElementById('approachYards').value) || null;
                // Putts are controlled by putting tracker when SG is enabled
                hole.putts = parseInt(document.getElementById('putts').value) || 0;
            } else {
                hole.approachYards = null;
                // Manual putt entry when SG is disabled
                hole.putts = parseInt(document.getElementById('putts').value) || 0;
            }

            hole.fairway = document.getElementById('fairway').checked;
            hole.updown = document.getElementById('updown').checked;

            // Calculate GIR automatically
            hole.gir = calculateGIR(hole.par, hole.score, hole.putts);

            const activeBtn = document.querySelector('.penalty-btn.active');
            hole.penalty = activeBtn ? activeBtn.dataset.penalty : 'none';
        }

        function nextHole() {
            saveCurrentHole();
            const totalHoles = currentRound.holes.length;
            if (currentRound.currentHole < totalHoles - 1) {
                loadHole(currentRound.currentHole + 1);
            }
        }

        function previousHole() {
            saveCurrentHole();
            if (currentRound.currentHole > 0) {
                loadHole(currentRound.currentHole - 1);
            }
        }

        function finishRound() {
            saveCurrentHole();

            const stats = calculateStats();
            currentRound.stats = stats;

            // Save round to user's history
            saveRoundToHistory();

            displaySummary(stats);

            hideAllScreens();
            document.getElementById('roundSummary').classList.remove('hidden');
        }

        function calculateStats() {
            let totalScore = 0;
            let totalPar = 0;
            let totalPutts = 0;
            let fairwaysHit = 0;
            let fairwayOpportunities = 0;
            let girHit = 0;

            currentRound.holes.forEach(hole => {
                totalScore += hole.score;
                totalPar += hole.par;
                totalPutts += hole.putts;

                if (hole.par > 3) {
                    fairwayOpportunities++;
                    if (hole.fairway) fairwaysHit++;
                }

                if (hole.gir) girHit++;
            });

            const totalHoles = currentRound.holes.length;
            const sgPutting = calculateStrokesGainedPutting();
            const sgApproach = calculateStrokesGainedApproach();
            const sgOffTee = calculateStrokesGainedOffTee();

            return {
                totalScore,
                totalPar,
                vsPar: totalScore - totalPar,
                totalPutts,
                fairwayPercentage: fairwayOpportunities > 0 ? Math.round((fairwaysHit / fairwayOpportunities) * 100) : 0,
                girPercentage: Math.round((girHit / totalHoles) * 100),
                strokesGainedPutting: sgPutting.total,
                sgPuttingBreakdown: sgPutting.breakdown,
                strokesGainedApproach: sgApproach.total,
                sgApproachHoles: sgApproach.holesWithData,
                strokesGainedOffTee: sgOffTee.total,
                sgOffTeeHoles: sgOffTee.holesWithData
            };
        }

        function displaySummary(stats) {
            document.getElementById('finalScore').textContent = stats.totalScore;
            document.getElementById('finalVsPar').textContent = (stats.vsPar > 0 ? '+' : '') + stats.vsPar;
            document.getElementById('finalFairways').textContent = stats.fairwayPercentage + '%';
            document.getElementById('finalGIR').textContent = stats.girPercentage + '%';
            document.getElementById('finalPutts').textContent = stats.totalPutts;

            // Display Strokes Gained Off The Tee
            const sgOffTee = stats.strokesGainedOffTee || 0;
            const sgOffTeeElement = document.getElementById('finalSGOffTee');
            if (!currentRound.enableStrokesGained) {
                sgOffTeeElement.textContent = 'Disabled';
                sgOffTeeElement.style.color = '#666';
            } else if (stats.sgOffTeeHoles > 0) {
                sgOffTeeElement.textContent = (sgOffTee > 0 ? '+' : '') + sgOffTee.toFixed(2);
                sgOffTeeElement.style.color = sgOffTee >= 0 ? '#28a745' : '#dc3545';
            } else {
                sgOffTeeElement.textContent = 'N/A';
                sgOffTeeElement.style.color = '#666';
            }

            // Display Strokes Gained Approach
            const sgApproach = stats.strokesGainedApproach || 0;
            const sgApproachElement = document.getElementById('finalSGApproach');
            if (!currentRound.enableStrokesGained) {
                sgApproachElement.textContent = 'Disabled';
                sgApproachElement.style.color = '#666';
            } else if (stats.sgApproachHoles > 0) {
                sgApproachElement.textContent = (sgApproach > 0 ? '+' : '') + sgApproach.toFixed(2);
                sgApproachElement.style.color = sgApproach >= 0 ? '#28a745' : '#dc3545';
            } else {
                sgApproachElement.textContent = 'N/A';
                sgApproachElement.style.color = '#666';
            }

            // Display Strokes Gained Putting
            const sgPutting = stats.strokesGainedPutting || 0;
            const sgElement = document.getElementById('finalSGPutting');
            if (!currentRound.enableStrokesGained) {
                sgElement.textContent = 'Disabled';
                sgElement.style.color = '#666';
            } else {
                sgElement.textContent = (sgPutting > 0 ? '+' : '') + sgPutting.toFixed(2);
                sgElement.style.color = sgPutting >= 0 ? '#28a745' : '#dc3545';
            }

            // Display SG Putting breakdown
            const breakdown = stats.sgPuttingBreakdown || [];
            let breakdownHtml;

            if (!currentRound.enableStrokesGained) {
                breakdownHtml = '<p style="color: #666; font-size: 12px; text-align: center;">Strokes Gained analysis was disabled for this round</p>';
            } else if (breakdown.length > 0) {
                breakdownHtml = `
                    <div style="font-size: 12px; color: #666; margin-bottom: 10px;">
                        Hole-by-hole putting performance vs PGA Tour average:
                    </div>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)); gap: 5px; font-size: 11px;">
                        ${breakdown.map(hole => `
                            <div style="text-align: center; padding: 3px; background: ${hole.sg >= 0 ? '#d4edda' : '#f8d7da'}; border-radius: 4px;">
                                <div style="font-weight: bold;">H${hole.hole}</div>
                                <div style="color: ${hole.sg >= 0 ? '#155724' : '#721c24'};">
                                    ${hole.sg > 0 ? '+' : ''}${hole.sg.toFixed(2)}
                                </div>
                                <div style="font-size: 10px; color: #666;">${hole.putts}p</div>
                            </div>
                        `).join('')}
                    </div>
                    <div style="text-align: center; margin-top: 10px; font-size: 13px; color: #666;">
                        ${sgPutting >= 0 ? '🎉 Above' : '📉 Below'} PGA Tour average by <strong>${Math.abs(sgPutting).toFixed(2)} strokes</strong>
                    </div>
                `;
            } else {
                breakdownHtml = '<p style="color: #666; font-size: 12px; text-align: center;">No detailed putting data recorded</p>';
            }

            document.getElementById('sgPuttingBreakdown').innerHTML = breakdownHtml;

            // Display SG Off The Tee breakdown
            const sgOffTeeBreakdown = document.getElementById('sgOffTeeBreakdown');
            if (!currentRound.enableStrokesGained) {
                sgOffTeeBreakdown.innerHTML = `
                    <p style="color: #666; font-size: 12px;">
                        Strokes Gained analysis was disabled for this round.
                    </p>
                `;
            } else if (stats.sgOffTeeHoles > 0) {
                sgOffTeeBreakdown.innerHTML = `
                    <p style="margin: 5px 0;">
                        Driving analyzed on <strong>${stats.sgOffTeeHoles}</strong> holes (Par 4s & 5s)
                    </p>
                    <p style="margin: 5px 0; font-weight: bold;">
                        ${sgOffTee >= 0 ? '⬆️ Better' : '⬇️ Worse'} than PGA Tour average by 
                        <span style="color: ${sgOffTee >= 0 ? '#28a745' : '#dc3545'};">
                            ${Math.abs(sgOffTee).toFixed(2)} strokes
                        </span>
                    </p>
                    <p style="margin: 5px 0; font-size: 12px; color: #666;">
                        Based on hole length vs. position after tee shot
                    </p>
                `;
            } else {
                sgOffTeeBreakdown.innerHTML = `
                    <p style="color: #666; font-size: 12px;">
                        No driving data recorded this round.<br>
                        Need both hole yardage and approach distance for analysis.
                    </p>
                `;
            }

            // Display SG Approach breakdown
            const sgApproachBreakdown = document.getElementById('sgApproachBreakdown');
            if (!currentRound.enableStrokesGained) {
                sgApproachBreakdown.innerHTML = `
                    <p style="color: #666; font-size: 12px;">
                        Strokes Gained analysis was disabled for this round.
                    </p>
                `;
            } else if (stats.sgApproachHoles > 0) {
                sgApproachBreakdown.innerHTML = `
                    <p style="margin: 5px 0;">
                        Approach shots tracked on <strong>${stats.sgApproachHoles}</strong> holes
                    </p>
                    <p style="margin: 5px 0; font-weight: bold;">
                        ${sgApproach >= 0 ? '⬆️ Better' : '⬇️ Worse'} than PGA Tour average by 
                        <span style="color: ${sgApproach >= 0 ? '#28a745' : '#dc3545'};">
                            ${Math.abs(sgApproach).toFixed(2)} strokes
                        </span>
                    </p>
                    <p style="margin: 5px 0; font-size: 12px; color: #666;">
                        Based on distance to pin for approach shots
                    </p>
                `;
            } else {
                sgApproachBreakdown.innerHTML = `
                    <p style="color: #666; font-size: 12px;">
                        No approach shot distances recorded this round.<br>
                        Enter approach yardage on each hole for analysis.
                    </p>
                `;
            }

            // Update scorecard with pars and scores
            let outPar = 0, inPar = 0;
            let outScore = 0, inScore = 0;

            // Clear all scorecard cells first
            for (let i = 1; i <= 18; i++) {
                document.getElementById(`par${i}`).textContent = '-';
                document.getElementById(`score${i}`).textContent = '-';
            }

            // Fill in the holes that were played
            currentRound.holes.forEach((hole, index) => {
                document.getElementById(`par${hole.number}`).textContent = hole.par;
                document.getElementById(`score${hole.number}`).textContent = hole.score;

                if (hole.number <= 9) {
                    outPar += hole.par;
                    outScore += hole.score;
                } else {
                    inPar += hole.par;
                    inScore += hole.score;
                }
            });

            document.getElementById('parOut').textContent = outPar || '-';
            document.getElementById('parIn').textContent = inPar || '-';
            document.getElementById('parTotal').textContent = stats.totalPar;
            document.getElementById('scoreOut').textContent = outScore || '-';
            document.getElementById('scoreIn').textContent = inScore || '-';
            document.getElementById('scoreTotal').textContent = stats.totalScore;
        }

        // Data persistence functions
        function saveRoundToHistory() {
            const users = JSON.parse(localStorage.getItem('golfTrackerUsers') || '{}');
            if (!users[currentUser].rounds) {
                users[currentUser].rounds = [];
            }
            users[currentUser].rounds.push(currentRound);
            localStorage.setItem('golfTrackerUsers', JSON.stringify(users));
        }

        function loadRoundHistory() {
            const users = JSON.parse(localStorage.getItem('golfTrackerUsers') || '{}');
            const rounds = users[currentUser]?.rounds || [];
            const historyList = document.getElementById('historyList');

            if (rounds.length === 0) {
                historyList.innerHTML = '<p style="text-align: center; color: #666;">No rounds recorded yet</p>';
                return;
            }

            historyList.innerHTML = rounds.reverse().map(round => {
                const roundTypeText = round.roundType === '9' ? '9 holes (Front)' :
                    round.roundType === 'back9' ? '9 holes (Back)' : '18 holes';

                const sgIndicator = round.enableStrokesGained !== false ? ' • 📊 SG' : '';

                return `
                    <div class="history-item" onclick="viewRound('${round.id}')">
                        <div class="history-info">
                            <h4>${round.course}</h4>
                            <p>${new Date(round.date).toLocaleDateString()} • ${round.tees || 'Regular'} tees • ${roundTypeText}${sgIndicator}</p>
                        </div>
                        <div class="history-stats">
                            <div class="score-display">${round.stats.totalScore}</div>
                            <p style="color: #666; font-size: 14px;">${round.stats.vsPar > 0 ? '+' : ''}${round.stats.vsPar}</p>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function viewRound(roundId) {
            const users = JSON.parse(localStorage.getItem('golfTrackerUsers') || '{}');
            const round = users[currentUser].rounds.find(r => r.id == roundId);
            if (round) {
                currentRound = round;
                displaySummary(round.stats);
                hideAllScreens();
                document.getElementById('roundSummary').classList.remove('hidden');
            }
        }

        function calculateUserStats() {
            const users = JSON.parse(localStorage.getItem('golfTrackerUsers') || '{}');
            const rounds = users[currentUser]?.rounds || [];

            if (rounds.length === 0) {
                document.getElementById('statsContent').innerHTML = '<p style="text-align: center; color: #666;">No rounds recorded yet</p>';
                return;
            }

            // Calculate averages
            let totalScore = 0;
            let totalPutts = 0;
            let totalFairways = 0;
            let totalGIR = 0;
            let totalSGPutting = 0;
            let totalSGApproach = 0;
            let totalSGOffTee = 0;
            let sgPuttingRounds = 0;
            let sgApproachRounds = 0;
            let sgOffTeeRounds = 0;
            let totalHoles = 0;
            let bestScore = Infinity;
            let worstScore = -Infinity;

            // For yardage analysis
            let yardageData = {};
            let approachData = {};

            rounds.forEach(round => {
                const stats = round.stats;
                totalScore += stats.vsPar;
                totalPutts += stats.totalPutts;
                totalFairways += stats.fairwayPercentage;
                totalGIR += stats.girPercentage;
                totalHoles += round.holes.length;

                if (stats.strokesGainedPutting !== undefined && round.enableStrokesGained !== false) {
                    totalSGPutting += stats.strokesGainedPutting;
                    sgPuttingRounds++;
                }

                if (stats.strokesGainedApproach !== undefined && stats.sgApproachHoles > 0 && round.enableStrokesGained !== false) {
                    totalSGApproach += stats.strokesGainedApproach;
                    sgApproachRounds++;
                }

                if (stats.strokesGainedOffTee !== undefined && stats.sgOffTeeHoles > 0 && round.enableStrokesGained !== false) {
                    totalSGOffTee += stats.strokesGainedOffTee;
                    sgOffTeeRounds++;
                }

                if (stats.vsPar < bestScore) bestScore = stats.vsPar;
                if (stats.vsPar > worstScore) worstScore = stats.vsPar;

                // Collect hole data for yardage analysis
                round.holes.forEach(hole => {
                    if (hole.yardage && hole.yardage > 0) {
                        // Group holes into yardage ranges
                        let range;
                        if (hole.yardage < 150) range = '< 150';
                        else if (hole.yardage < 200) range = '150-199';
                        else if (hole.yardage < 250) range = '200-249';
                        else if (hole.yardage < 300) range = '250-299';
                        else if (hole.yardage < 350) range = '300-349';
                        else if (hole.yardage < 400) range = '350-399';
                        else if (hole.yardage < 450) range = '400-449';
                        else if (hole.yardage < 500) range = '450-499';
                        else range = '500+';

                        if (!yardageData[range]) {
                            yardageData[range] = { totalScore: 0, totalPar: 0, count: 0 };
                        }
                        yardageData[range].totalScore += hole.score;
                        yardageData[range].totalPar += hole.par;
                        yardageData[range].count++;
                    }

                    // Collect approach yardage data for GIR analysis (only if strokes gained was enabled)
                    if (round.enableStrokesGained !== false && hole.approachYards && hole.approachYards > 0) {
                        let approachRange;
                        if (hole.approachYards < 50) approachRange = '< 50';
                        else if (hole.approachYards < 75) approachRange = '50-74';
                        else if (hole.approachYards < 100) approachRange = '75-99';
                        else if (hole.approachYards < 125) approachRange = '100-124';
                        else if (hole.approachYards < 150) approachRange = '125-149';
                        else if (hole.approachYards < 175) approachRange = '150-174';
                        else if (hole.approachYards < 200) approachRange = '175-199';
                        else approachRange = '200+';

                        if (!approachData[approachRange]) {
                            approachData[approachRange] = { totalGIR: 0, count: 0 };
                        }
                        approachData[approachRange].totalGIR += hole.gir ? 1 : 0;
                        approachData[approachRange].count++;
                    }
                });
            });

            const avgScore = Math.round(totalScore / rounds.length);
            const avgPutts = Math.round(totalPutts / totalHoles * 10) / 10; // Average putts per hole
            const avgFairways = Math.round(totalFairways / rounds.length);
            const avgGIR = Math.round(totalGIR / rounds.length);
            const avgSGPutting = sgPuttingRounds > 0 ? (totalSGPutting / sgPuttingRounds) : 0;
            const avgSGApproach = sgApproachRounds > 0 ? (totalSGApproach / sgApproachRounds) : 0;
            const avgSGOffTee = sgOffTeeRounds > 0 ? (totalSGOffTee / sgOffTeeRounds) : 0;

            // Create yardage chart data
            const yardageRanges = ['< 150', '150-199', '200-249', '250-299', '300-349', '350-399', '400-449', '450-499', '500+'];
            let yardageChartHTML = '';

            if (Object.keys(yardageData).length > 0) {
                const maxAvg = Math.max(...yardageRanges.map(range =>
                    yardageData[range] ? (yardageData[range].totalScore / yardageData[range].count) : 0
                ));

                yardageChartHTML = `
                    <div style="margin-top: 30px; padding: 20px; background: #f8f9fa; border-radius: 10px;">
                        <h3 style="color: #2a5298; margin-bottom: 20px; text-align: center;">📏 Scoring by Hole Length</h3>
                        <div style="display: flex; align-items: end; gap: 5px; height: 200px; margin-bottom: 10px; padding: 0 10px;">
                            ${yardageRanges.map(range => {
                    if (!yardageData[range] || yardageData[range].count === 0) {
                        return `
                                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                            <div style="height: 20px; background: #e0e0e0; width: 100%; border-radius: 4px 4px 0 0; margin-bottom: 5px; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #666;">N/A</div>
                                            <div style="font-size: 10px; color: #666; text-align: center; transform: rotate(-45deg); white-space: nowrap; margin-top: 15px;">${range}</div>
                                        </div>
                                    `;
                    }

                    const avg = yardageData[range].totalScore / yardageData[range].count;
                    const avgVsPar = avg - (yardageData[range].totalPar / yardageData[range].count);
                    const height = Math.max(20, (avg / maxAvg) * 160);
                    const color = avgVsPar <= 0 ? '#28a745' : avgVsPar <= 1 ? '#ffc107' : '#dc3545';

                    return `
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: ${height}px; background: ${color}; width: 100%; border-radius: 4px 4px 0 0; margin-bottom: 5px; display: flex; align-items: center; justify-content: center; font-size: 10px; color: white; font-weight: bold;">${avg.toFixed(1)}</div>
                                        <div style="font-size: 9px; color: #666; text-align: center;">
                                            <div>${range}</div>
                                            <div style="font-size: 8px;">(${yardageData[range].count} holes)</div>
                                        </div>
                                    </div>
                                `;
                }).join('')}
                        </div>
                        <div style="text-align: center; font-size: 12px; color: #666; margin-top: 10px;">
                            <span style="color: #28a745;">■</span> At or under par &nbsp;
                            <span style="color: #ffc107;">■</span> 1 over par &nbsp;
                            <span style="color: #dc3545;">■</span> 2+ over par
                        </div>
                        <div style="text-align: center; font-size: 11px; color: #666; margin-top: 5px;">
                            Yardage ranges (yards)
                        </div>
                    </div>
                `;
            }

            // Create approach GIR chart data
            const approachRanges = ['< 50', '50-74', '75-99', '100-124', '125-149', '150-174', '175-199', '200+'];
            let approachChartHTML = '';

            if (Object.keys(approachData).length > 0) {
                approachChartHTML = `
                    <div style="margin-top: 30px; padding: 20px; background: #e8f4fd; border-radius: 10px;">
                        <h3 style="color: #2a5298; margin-bottom: 20px; text-align: center;">🎯 GIR% by Approach Distance</h3>
                        <div style="display: flex; align-items: end; gap: 5px; height: 200px; margin-bottom: 10px; padding: 0 10px;">
                            ${approachRanges.map(range => {
                    if (!approachData[range] || approachData[range].count === 0) {
                        return `
                                        <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                            <div style="height: 20px; background: #e0e0e0; width: 100%; border-radius: 4px 4px 0 0; margin-bottom: 5px; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #666;">N/A</div>
                                            <div style="font-size: 10px; color: #666; text-align: center; transform: rotate(-45deg); white-space: nowrap; margin-top: 15px;">${range}</div>
                                        </div>
                                    `;
                    }

                    const girPercent = (approachData[range].totalGIR / approachData[range].count) * 100;
                    const height = Math.max(20, (girPercent / 100) * 160);

                    let color;
                    if (girPercent >= 70) color = '#28a745';      // Excellent (green)
                    else if (girPercent >= 50) color = '#ffc107'; // Good (yellow)
                    else if (girPercent >= 30) color = '#fd7e14'; // Fair (orange)
                    else color = '#dc3545';                       // Needs work (red)

                    return `
                                    <div style="flex: 1; display: flex; flex-direction: column; align-items: center;">
                                        <div style="height: ${height}px; background: ${color}; width: 100%; border-radius: 4px 4px 0 0; margin-bottom: 5px; display: flex; align-items: center; justify-content: center; font-size: 10px; color: white; font-weight: bold;">${girPercent.toFixed(0)}%</div>
                                        <div style="font-size: 9px; color: #666; text-align: center;">
                                            <div>${range}</div>
                                            <div style="font-size: 8px;">(${approachData[range].count} shots)</div>
                                        </div>
                                    </div>
                                `;
                }).join('')}
                        </div>
                        <div style="text-align: center; font-size: 12px; color: #666; margin-top: 10px;">
                            <span style="color: #28a745;">■</span> Excellent (70%+) &nbsp;
                            <span style="color: #ffc107;">■</span> Good (50-69%) &nbsp;
                            <span style="color: #fd7e14;">■</span> Fair (30-49%) &nbsp;
                            <span style="color: #dc3545;">■</span> Needs work (<30%)
                        </div>
                        <div style="text-align: center; font-size: 11px; color: #666; margin-top: 5px;">
                            Approach distance ranges (yards)
                        </div>
                    </div>
                `;
            }

            document.getElementById('statsContent').innerHTML = `
                <div class="summary-stats">
                    <div class="stat-box">
                        <div class="stat-value">${avgScore === 0 ? 'E' : (avgScore > 0 ? '+' : '') + avgScore}</div>
                        <div class="stat-label">Avg Score Vs Par</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">${avgPutts}</div>
                        <div class="stat-label">Avg Putts Per Hole</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">${avgFairways}%</div>
                        <div class="stat-label">Avg Fairways</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">${avgGIR}%</div>
                        <div class="stat-label">Avg GIR</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">${bestScore === 0 ? 'E' : (bestScore > 0 ? '+' : '') + bestScore}</div>
                        <div class="stat-label">Best Round</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-value">${rounds.length}</div>
                        <div class="stat-label">Total Rounds</div>
                    </div>
                    ${sgOffTeeRounds > 0 ? `
                    <div class="stat-box" style="border-left-color: #ff9800;">
                        <div class="stat-value" style="color: ${avgSGOffTee >= 0 ? '#28a745' : '#dc3545'};">
                            ${avgSGOffTee > 0 ? '+' : ''}${avgSGOffTee.toFixed(2)}
                        </div>
                        <div class="stat-label">Avg SG Off Tee</div>
                    </div>
                    ` : ''}
                    ${sgApproachRounds > 0 ? `
                    <div class="stat-box" style="border-left-color: #2a5298;">
                        <div class="stat-value" style="color: ${avgSGApproach >= 0 ? '#28a745' : '#dc3545'};">
                            ${avgSGApproach > 0 ? '+' : ''}${avgSGApproach.toFixed(2)}
                        </div>
                        <div class="stat-label">Avg SG Approach</div>
                    </div>
                    ` : ''}
                    ${sgPuttingRounds > 0 ? `
                    <div class="stat-box" style="border-left-color: #28a745;">
                        <div class="stat-value" style="color: ${avgSGPutting >= 0 ? '#28a745' : '#dc3545'};">
                            ${avgSGPutting > 0 ? '+' : ''}${avgSGPutting.toFixed(2)}
                        </div>
                        <div class="stat-label">Avg SG Putting</div>
                    </div>
                    ` : ''}
                </div>
                
                ${yardageChartHTML}
                
                ${approachChartHTML}
                
                ${sgOffTeeRounds > 0 ? `
                <div style="margin-top: 20px; text-align: center; padding: 15px; background: #fff3e0; border-radius: 10px;">
                    <p style="margin: 0; color: #ff9800; font-size: 14px; font-weight: bold;">
                        🏌️ Driving Performance
                    </p>
                    <p style="margin: 5px 0; color: #333; font-size: 14px;">
                        You're averaging <strong>${Math.abs(avgSGOffTee).toFixed(2)} strokes ${avgSGOffTee >= 0 ? 'better' : 'worse'}</strong> than PGA Tour average off the tee
                    </p>
                    <p style="margin: 0; color: #666; font-size: 12px;">
                        Based on ${sgOffTeeRounds} rounds with driving data
                    </p>
                </div>
                ` : ''}
                ${sgApproachRounds > 0 ? `
                <div style="margin-top: 20px; text-align: center; padding: 15px; background: #e8f4fd; border-radius: 10px;">
                    <p style="margin: 0; color: #2a5298; font-size: 14px; font-weight: bold;">
                        🏌️ Approach Shot Performance
                    </p>
                    <p style="margin: 5px 0; color: #333; font-size: 14px;">
                        You're averaging <strong>${Math.abs(avgSGApproach).toFixed(2)} strokes ${avgSGApproach >= 0 ? 'better' : 'worse'}</strong> than PGA Tour average on approach shots
                    </p>
                    <p style="margin: 0; color: #666; font-size: 12px;">
                        Based on ${sgApproachRounds} rounds with approach data
                    </p>
                </div>
                ` : ''}
                ${sgPuttingRounds > 0 ? `
                <div style="margin-top: 20px; text-align: center; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                    <p style="margin: 0; color: #666; font-size: 14px;">
                        🏌️‍♂️ You're averaging <strong>${Math.abs(avgSGPutting).toFixed(2)} strokes ${avgSGPutting >= 0 ? 'better' : 'worse'}</strong> than PGA Tour average on the greens
                    </p>
                </div>
                ` : ''}
            `;
        }

        // Touch handling for swipe navigation
        let touchStartX = 0;
        let touchEndX = 0;

        document.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        });

        document.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        });

        function handleSwipe() {
            const swipeThreshold = 50;
            const diff = touchStartX - touchEndX;
            const totalHoles = currentRound.holes.length;

            if (Math.abs(diff) > swipeThreshold && totalHoles > 0 && !document.getElementById('holeTracker').classList.contains('hidden')) {
                if (diff > 0 && currentRound.currentHole < totalHoles - 1) {
                    nextHole();
                } else if (diff < 0 && currentRound.currentHole > 0) {
                    previousHole();
                }
            }
        }
    </script>
</body>

</html>
